import{h as B,i as C,j as T,a1 as N,a as $,o as r,l as u,m as l,n as s,w as n,k as e,e as f,F as h,ap as H,aI as I,I as F,t as M,x as i,a6 as R,q as Y,y as q}from"./index.b340747c.js";import{Q as z}from"./QToolbarTitle.440d1fa8.js";import{Q as A}from"./QToolbar.f296e630.js";import{u as D,Q as L,p as V}from"./history.ba3244ca.js";import{Q as j}from"./QPullToRefresh.dec1c06c.js";import{_ as E,B as P}from"./ScreenError.29d1ac58.js";import{Q as G,f as J}from"./forceHttp2.94a52bc8.js";import{S as K}from"./ScreenLoading.62a007f7.js";import{S as O}from"./ScreenNotFound.3391fb98.js";import{Q as U}from"./QInfiniteScroll.323eba28.js";import{p as W}from"./urlImage.0db39262.js";import{u as X}from"./index.es.9bf2f817.js";import"./dayjs.937bb0b8.js";import"./touch.9d375472.js";import"./selection.b3caa21c.js";import"./index.a60c2c0b.js";const Z={class:"fixed w-full top-0 left-0 z-200 bg-dark-page"},tt={key:0,class:"text-subtitle2 text-weight-normal"},et={class:"w-[149px]"},st={class:"absolute bottom-0 left-0 z-10 w-full min-h-0 !py-0 !px-0"},at={class:"absolute text-white z-10 text-[12px] bottom-2 right-2"},ot={class:"flex-1 pl-2 min-w-0"},rt={class:"line-clamp-3"},lt={class:"text-grey mt-1"},nt={class:"text-grey mt-2"},it={class:"row justify-center q-my-md"},Bt=B({__name:"history",setup(ct){const y=C(),{t:_}=T(),x=D(),g=N(),{loading:v,data:a,run:k,refreshAsync:b,error:w}=X(c=>x.loadMoreAfter(c)),Q=c=>b().then(()=>{var o;return(o=g.value)==null?void 0:o.reset()}).then(c);async function S(c,o){var t,m,p;const d=await x.loadMoreAfter((m=(t=a.value)==null?void 0:t[a.value.length-1])==null?void 0:m.$doc);a.value=[...(p=a.value)!=null?p:[],...d],o(d.length===0)}return(c,o)=>{const d=$("router-link");return r(),u(h,null,[l("header",Z,[s(A,{class:"relative"},{default:n(()=>[s(H,{flat:"",dense:"",round:"",class:"mr-2",onClick:o[0]||(o[0]=I(t=>e(y).back(),["stop"]))},{default:n(()=>[s(e(F),{icon:"fluent:chevron-left-24-regular",width:"25",height:"25"})]),_:1}),s(z,{class:"absolute left-[50%] top-[50%] transform translate-x-[-50%] translate-y-[-50%] text-[16px] max-w-[calc(100%-34px*2)] line-clamp-1"},{default:n(()=>[M(i(e(_)("anime-da-xem")),1)]),_:1})]),_:1})]),e(v)?(r(),f(K,{key:0,class:"absolute pt-[47px]"})):e(a)?(r(),u(h,{key:1},[e(a).length===0?(r(),f(O,{key:0,class:"pt-[47px]"})):(r(),f(j,{key:1,onRefresh:Q,class:"pt-[47px] px-4"},{default:n(()=>[s(e(U),{onLoad:S,offset:250},{loading:n(()=>[l("div",it,[s(R,{class:"c--main",size:"40px"})])]),default:n(()=>[(r(!0),u(h,null,Y(e(a),(t,m)=>{var p;return r(),u(h,{key:t.id},[!e(a)[m-1]||!e(a)[m-1].timestamp.isSame(t.timestamp,"day")?(r(),u("div",tt,i(t.timestamp.isToday()?"H\xF4m nay":t.timestamp.isYesterday()?"H\xF4m qua":t.timestamp.get("date")+" thg "+(t.timestamp.get("month")+1)),1)):q("",!0),s(d,{class:"bg-transparent flex mt-1 mb-4",style:{"white-space":"initial"},to:`/phim/${(p=t.season)!=null?p:t.id}/${e(W)(t.last.name)}-${t.last.chap}`},{default:n(()=>[l("div",et,[s(e(G),{"no-spinner":"",src:e(J)(t.poster),referrerpolicy:"no-referrer",ratio:1920/1080,class:"!rounded-[4px]"},{default:n(()=>[s(P,{class:"px-0 h-[40%]"},{default:n(()=>[l("div",st,[s(L,{value:t.last.cur/t.last.dur,rounded:"",color:"main",class:"!h-[3px]"},null,8,["value"])])]),_:2},1024),l("span",at,i(e(V)(t.last.cur)),1)]),_:2},1032,["src"])]),l("div",ot,[l("span",rt,i(t.name),1),l("div",lt,i(t.seasonName)+" t\u1EADp "+i(t.last.name),1),l("div",nt,i(e(_)("xem-luc-_value",[t.timestamp.format(t.timestamp.isToday()?"HH:mm":"DD/MM/YYYY")])),1)])]),_:2},1032,["to"])],64)}),128))]),_:1})]),_:1}))],64)):(r(),f(E,{key:2,"onClick:retry":o[1]||(o[1]=t=>e(k)()),class:"absolute mt-[47px]",error:e(w)},null,8,["error"]))],64)}}});export{Bt as default};
