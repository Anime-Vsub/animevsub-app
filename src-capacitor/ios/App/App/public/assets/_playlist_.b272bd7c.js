import{_ as oe,h as ne,j as ie,aF as re,i as ue,b5 as de,a1 as A,a2 as q,a as ce,o as c,l as v,m as i,n as e,w as a,k as t,e as E,y as B,p as pe,t as p,x as u,ap as y,aI as I,bC as H,F as T,I as b,A as fe,ah as j,a6 as me,q as he}from"./index.b340747c.js";import{Q as ve}from"./QToolbarTitle.440d1fa8.js";import{Q as ye}from"./QToolbar.f296e630.js";import{b as z,a as N,Q as k}from"./QList.49fcf7be.js";import{Q as $}from"./QItemLabel.04b33259.js";import{A as _e,Q as L}from"./AddToPlaylist.63bb2dcb.js";import{f as M,Q as O}from"./forceHttp2.94a52bc8.js";import{Q as ge}from"./QInfiniteScroll.323eba28.js";import"./dayjs.937bb0b8.js";import{p as xe}from"./urlImage.0db39262.js";import{u as be}from"./playlist.7417ec6b.js";import{u as K}from"./index.es.9bf2f817.js";import"./selection.b3caa21c.js";import"./ClosePopup.958d94b2.js";const we={class:"fixed w-full top-0 left-0 z-200 bg-transparent"},ke={key:0,class:"md:row"},Ce={class:"md:w-[360px]"},Ae={class:"md:fixed md:h-[calc(100vh-58px)] md:w-[360px] py-4 <md:pt-0"},Qe={class:"relative md:h-full bg-[#594d42] px-5 py-6 overflow-hidden md:rounded-[15px]"},Pe={class:"absolute top-0 left-0 right-0 bottom-0"},Se={class:"w-[200%] opacity-[0.7] transform translate-x-[-25%] filter blur-[30px]"},De={class:"<md:mt-[47px] relative z-2"},Ne={key:0,class:"text-[28px] text-weight-medium py-6 leading-normal flex items-center justify-between"},$e=["onSubmit"],Fe={class:"flex items-center justify-end mt-1 mr-[-16px] text-[16px]"},Ee={class:"text-[13px] text-[rgba(255,255,255,0.7)]"},Ie={key:1,class:"mt-6 flex"},Te={class:"flex-1"},Ve=["onSubmit"],qe={class:"flex items-center justify-end mt-1 mr-[-16px] text-[16px]"},Be={class:"md:col md:pl-4 md:pt-4 mx-4"},je={class:"text-[16px]"},ze={class:"pl-2 flex-1"},Le={class:"line-clamp-3 mt-1 font-weight-medium leading-normal text-[16px]"},Me={class:"text-grey mt-1"},Oe={class:"items-center flex md:pr-6"},Re={class:"row justify-center q-my-md"},Ue={key:1,class:"text-center pt-4"},Ge=ne({__name:"[playlist]",setup(We){const{t:n}=ie(),h=re(),V=ue(),m=de(),f=be(),R=A(),{data:r,run:J,error:X}=K(async()=>{const{playlists:o}=f;if(!o)return o;const s=o.find(x=>x.id===h.params.playlist);if(!s)throw new Error("NOT_FOUND");const d=await f.getPosterPlaylist(s.id);return{...s,poster:d}},{refreshDeps:[()=>f.playlists,()=>h.params.playlist],refreshDepsAction(){!h.params.playlist||J()}});q(X,o=>{(o==null?void 0:o.message)==="NOT_FOUND"&&(m.notify({message:n("danh-sach-phat-khong-ton-tai")}),V.push({name:"not_found",params:{catchAll:h.path.split("/").slice(1)},query:h.query,hash:h.hash}))});const C=A("asc"),{data:_,run:Y}=K(()=>{var o;return(o=R.value)==null||o.reset(),f.getAnimesFromPlaylist(h.params.playlist,void 0,C.value)},{refreshDeps:[()=>h.params.playlist,C],refreshDepsAction(){!h.params.playlist||Y()}});async function Z(o,s){var l,F,W;const{playlists:d}=f;if(!d)return s(!0);const x=d.find(le=>le.id===h.params.playlist);if(!x)throw new Error(n("danh-sach-phat-khong-ton-tai"));const w=await f.getAnimesFromPlaylist(x.id,(F=(l=_.value)==null?void 0:l[_.value.length-1])==null?void 0:F.$doc,C.value);_.value=[...(W=_.value)!=null?W:[],...w],s(w.length===0)}const P=A(!1),Q=A(!1),S=A("");q(P,o=>{var s,d;o?S.value=(d=(s=r.value)==null?void 0:s.name)!=null?d:"":S.value=""});const D=A("");q(Q,o=>{var s,d;o?D.value=(d=(s=r.value)==null?void 0:s.description)!=null?d:"":D.value=""});async function ee(){try{if(!r.value)throw new Error(n("danh-sach-phat-khong-ton-tai"));await f.renamePlaylist(r.value.id,S.value),P.value=!1,m.notify({position:"bottom-right",message:n("da-cap-nhat-ten-danh-sach-phat")})}catch(o){m.notify({position:"bottom-right",message:o.message})}}async function te(){try{if(!r.value)throw new Error(n("danh-sach-phat-khong-ton-tai"));await f.setDescriptionPlaylist(r.value.id,D.value),Q.value=!1,m.notify({position:"bottom-right",message:n("da-cap-nhat-mo-ta-danh-sach-phat")})}catch(o){m.notify({position:"bottom-right",message:o.message})}}async function ae(){try{if(!r.value)throw new Error(n("danh-sach-phat-khong-ton-tai"));await f.deletePlaylist(r.value.id),Q.value=!1,V.push("/tai-khoan/follow"),m.notify({position:"bottom-right",message:n("da-xoa-danh-sach-phat")})}catch(o){m.notify({position:"bottom-right",message:o.message})}}const g=A(null),se=o=>g.value?f.hasAnimeOfPlaylist(o,g.value.season):!1;async function U(o){if(!!g.value)try{await f.addAnimeToPlaylist(o,g.value.season,g.value.$doc.data()),m.notify({position:"bottom-right",message:n("da-theo-vao-danh-sach-phat")})}catch(s){m.notify({position:"bottom-right",message:s.message})}}async function G(o=(d=>(d=r.value)==null?void 0:d.id)(),s=(x=>(x=g.value)==null?void 0:x.season)()){var w;if(!(!o||!s))try{await f.deleteAnimeFromPlaylist(o,s),m.notify({position:"bottom-right",message:n("da-xoa-khoi-danh-sach-phat")}),_.value=(w=_.value)==null?void 0:w.filter(l=>l.season!==s)}catch(l){m.notify({position:"bottom-right",message:l.message})}}return(o,s)=>{var x,w;const d=ce("router-link");return c(),v(T,null,[i("header",we,[e(ye,{class:"relative"},{default:a(()=>[e(y,{flat:"",dense:"",round:"",class:"mr-2",onClick:s[0]||(s[0]=I(l=>t(V).back(),["stop"]))},{default:a(()=>[e(t(b),{icon:"fluent:chevron-left-24-regular",width:"25",height:"25"})]),_:1}),e(ve,{class:"text-[16px] line-clamp-1"},{default:a(()=>{var l;return[p(u((l=t(r))==null?void 0:l.name),1)]}),_:1})]),_:1})]),t(r)&&t(_)?(c(),v("div",ke,[i("div",Ce,[i("div",Ae,[i("div",Qe,[i("div",Pe,[i("div",Se,[t(r).poster?(c(),E(t(O),{key:0,class:"h-auto w-full",src:t(M)(t(r).poster),referrerpolicy:"no-referrer"},null,8,["src"])):B("",!0)]),i("div",{class:"absolute top-0 left-0 right-0 bottom-0",style:pe({background:`linear-gradient(
                  to bottom,
                  rgba(89, 77, 66, 0.8) 0%,
                  rgba(89, 77, 66, 0.298) 33%,
                  var(--q-dark-page) 100%
                )`})},null,4)]),i("div",De,[t(r).poster?(c(),E(t(O),{key:0,class:"rounded-xl",src:t(M)(t(r).poster),referrerpolicy:"no-referrer"},null,8,["src"])):B("",!0),i("div",null,[P.value?(c(),v("form",{key:1,onSubmit:I(ee,["prevent"]),class:"py-6"},[e(H,{modelValue:S.value,"onUpdate:modelValue":s[2]||(s[2]=l=>S.value=l),"bottom-slots":"",placeholder:t(n)("tieu-de"),counter:"",maxlength:"150",dense:"",class:"fix-input","stack-label":"","input-style":{fontSize:"28px",fontWeight:"500",paddingLeft:"0px"},color:"white",rules:[l=>!!l||"B\u1EAFt bu\u1ED9c"]},null,8,["modelValue","placeholder","rules"]),i("div",Fe,[e(y,{rounded:"",unelevated:"","no-caps":"",onClick:s[3]||(s[3]=l=>P.value=!1)},{default:a(()=>[p(u(t(n)("huy")),1)]),_:1}),e(y,{rounded:"",unelevated:"","no-caps":"",type:"submit"},{default:a(()=>[p(u(t(n)("luu")),1)]),_:1})])],40,$e)):(c(),v("div",Ne,[p(u(t(r).name)+" ",1),e(y,{round:"",unelevated:"",dense:"",flat:"",class:"text-[14px]",onClick:s[1]||(s[1]=l=>P.value=!0)},{default:a(()=>[e(t(b),{icon:"fluent:edit-24-regular",width:"22",height:"22"})]),_:1})])),i("div",Ee,u(t(r).size)+" video C\u1EADp nh\u1EADt "+u(t(fe)(((x=t(r).updated)!=null?x:t(r).created).toDate()).fromNow()),1)]),e(y,{round:"",unelevated:"",dense:"",class:"mt-7 bg-[rgba(255,255,255,0.1)] w-[36px] h-[36px]"},{default:a(()=>[e(t(b),{icon:"fluent:more-vertical-24-regular",width:"25",height:"25"}),e(L,{class:"rounded-xl bg-dark-menu"},{default:a(()=>[e(j,{class:"transparent"},{default:a(()=>[e(z,{class:"transparent"},{default:a(()=>[e(N,{clickable:"",onClick:ae},{default:a(()=>[e(k,{avatar:"",class:"min-w-0"},{default:a(()=>[e(t(b),{icon:"fluent:delete-24-regular",width:"20",height:"20"})]),_:1}),e(k,null,{default:a(()=>[e($,null,{default:a(()=>[p(u(t(n)("xoa-danh-sach-phat")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),Q.value?(c(),v("form",{key:2,onSubmit:I(te,["prevent"]),class:"pt-6"},[e(H,{modelValue:D.value,"onUpdate:modelValue":s[5]||(s[5]=l=>D.value=l),"bottom-slots":"",placeholder:t(n)("mo-ta"),counter:"",maxlength:"5000",dense:"",class:"fix-input","stack-label":"","input-style":{paddingLeft:"0px"},color:"white"},null,8,["modelValue","placeholder"]),i("div",qe,[e(y,{rounded:"",unelevated:"","no-caps":"",onClick:s[6]||(s[6]=l=>Q.value=!1)},{default:a(()=>[p(u(t(n)("huy")),1)]),_:1}),e(y,{rounded:"",unelevated:"","no-caps":"",type:"submit"},{default:a(()=>[p(u(t(n)("luu")),1)]),_:1})])],40,Ve)):(c(),v("div",Ie,[i("p",Te,u((w=t(r).description)!=null?w:"Kh\xF4ng c\xF3 th\xF4ng tin m\xF4 t\u1EA3"),1),e(y,{round:"",unelevated:"",dense:"",flat:"",class:"text-[14px]",onClick:s[4]||(s[4]=l=>Q.value=!0)},{default:a(()=>[e(t(b),{icon:"fluent:edit-24-regular",width:"22",height:"22"})]),_:1})]))])])])]),i("div",Be,[t(_).length>0?(c(),E(t(ge),{key:0,ref_key:"infiniteScrollRef",ref:R,onLoad:Z,offset:250},{loading:a(()=>[i("div",Re,[e(me,{class:"c--main",size:"40px"})])]),default:a(()=>[e(y,{rounded:"","no-caps":"",class:"mb-2"},{default:a(()=>[e(t(b),{icon:"fluent:text-align-left-24-regular",width:"23",height:"23",class:"mr-2"}),i("span",je,u(t(n)("sap-xep")),1),e(L,{class:"rounded-xl bg-dark-menu","auto-close":""},{default:a(()=>[e(j,{class:"transparent"},{default:a(()=>[e(z,{class:"transparent"},{default:a(()=>[e(N,{clickable:"",focused:C.value==="asc",onClick:s[7]||(s[7]=l=>C.value="asc")},{default:a(()=>[e(k,null,{default:a(()=>[e($,null,{default:a(()=>[p(u(t(n)("ngay-them-moi-nhat")),1)]),_:1})]),_:1})]),_:1},8,["focused"]),e(N,{clickable:"",focused:C.value==="desc",onClick:s[8]||(s[8]=l=>C.value="desc")},{default:a(()=>[e(k,null,{default:a(()=>[e($,null,{default:a(()=>[p(u(t(n)("ngay-them-cu-nhat")),1)]),_:1})]),_:1})]),_:1},8,["focused"])]),_:1})]),_:1})]),_:1})]),_:1}),(c(!0),v(T,null,he(t(_),l=>(c(),E(d,{key:l.season,class:"bg-transparent flex flex-nowrap mb-5 group",style:{"white-space":"initial"},to:`/phim/${l.season}/${t(xe)(l.name)}-${l.chap}`},{default:a(()=>[i("div",null,[e(t(O),{"no-spinner":"",src:t(M)(l.poster),referrerpolicy:"no-referrer",ratio:1920/1080,class:"!rounded-xl w-[150px]"},null,8,["src"])]),i("div",ze,[i("span",Le,u(l.name),1),i("div",Me,[l.nameSeason?(c(),v(T,{key:0},[p(u(t(n)("_season-tap",[l.nameSeason])),1)],64)):(c(),v(T,{key:1},[p(u(t(n)("Tap")),1)],64)),p(" "+u(l.nameChap),1)])]),i("div",Oe,[e(y,{flat:"",round:"",onClick:s[9]||(s[9]=I(()=>{},["prevent"]))},{default:a(()=>[e(t(b),{icon:"fluent:more-vertical-24-regular",width:"25",height:"25"}),e(L,{class:"rounded-xl bg-dark-menu"},{default:a(()=>[e(j,{class:"transparent"},{default:a(()=>[e(z,{class:"transparent"},{default:a(()=>[e(N,{clickable:"",onClick:F=>g.value=l},{default:a(()=>[e(k,{avatar:"",class:"min-w-0"},{default:a(()=>[e(t(b),{icon:"fluent:add-square-multiple-16-regular",width:"20",height:"20"})]),_:1}),e(k,null,{default:a(()=>[e($,null,{default:a(()=>[p(u(t(n)("them-vao-danh-sach-phat")),1)]),_:1})]),_:1})]),_:2},1032,["onClick"]),e(N,{clickable:"",onClick:F=>G(void 0,l.season)},{default:a(()=>[e(k,{avatar:"",class:"min-w-0"},{default:a(()=>[e(t(b),{icon:"fluent:delete-24-regular",width:"20",height:"20"})]),_:1}),e(k,null,{default:a(()=>[e($,null,{default:a(()=>[p(u(t(n)("xoa-khoi-danh-sach-phat")),1)]),_:1})]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),_:2},1032,["to"]))),128))]),_:1},512)):(c(),v("div",Ue,u(t(n)("chua-co-video-nao-trong-danh-sach-phat-nay")),1))])])):B("",!0),e(_e,{"model-value":g.value!==null,"onUpdate:modelValue":s[10]||(s[10]=l=>{l||(g.value=null)}),exists:se,"onAction:add":U,"onAction:del":G,onAfterCreatePlaylist:U},null,8,["model-value"])],64)}}});var rt=oe(Ge,[["__scopeId","data-v-6bb4e557"]]);export{rt as default};
