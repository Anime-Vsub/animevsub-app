import{aV as Y,P as Z,aW as de,_ as pe,h as fe,i as me,aF as ve,j as he,H as _e,a1 as S,a2 as T,aT as ye,aX as N,ae as ke,aU as we,o as s,l as c,m as i,n,w as o,k as e,y as j,e as u,F as _,s as Q,aY as q,ap as ge,I as b,aZ as xe,a_ as Se,q as C,x as g,aI as be,ai as Ce,t as Ie,z as je,a6 as Qe,R as Re,B as Be,C as Te}from"./index.b340747c.js";import{S as $e,a as We}from"./swiper.min.f3fa348a.js";import{_ as D,B as F}from"./ScreenError.29d1ac58.js";import{_ as z}from"./CardVertical.bd65ab39.js";import{S as K}from"./ScreenLoading.62a007f7.js";import{S as Pe}from"./ScreenNotFound.3391fb98.js";import{Q as Ve}from"./QInfiniteScroll.323eba28.js";import{Q as $,a as Ae,b as Ee}from"./QList.49fcf7be.js";import{Q as Le}from"./QItemLabel.04b33259.js";import{Q as M}from"./QPullToRefresh.dec1c06c.js";import{Q as W}from"./QToolbar.f296e630.js";import{T as H}from"./_value_.a344ab39.js";import{u as G}from"./useCache.a72482f3.js";import{u as Ne}from"./useAliveScrollBehavior.af4f2067.js";import{r as qe}from"./ranks.6b7a2e33.js";import{u as U}from"./index.es.9bf2f817.js";import"./index.a60c2c0b.js";import"./forceHttp2.94a52bc8.js";import"./touch.9d375472.js";import"./selection.b3caa21c.js";import"./_value_.7e1d0da8.js";function De(){return new Worker("assets/item.235658d1.js",{type:"module"})}async function X(p){return await G(`/ajax/item/${p}`,async()=>{const{data:x}=await Y("/ajax/item",{widget:"list-film",type:p});return Z(De,x)})}function Fe(){return new Worker("assets/pre-search.966eb420.js",{type:"module"})}async function ze(p){return await G(`/ajax/suggest?q=${p}`,async()=>{const{data:x}=await Y("/ajax/suggest",{ajaxSearch:"1",keysearch:p});return Z(Fe,x)})}const Ke=de("history-search",{state:()=>({items:[]}),persist:!0});const Me=p=>(Be("data-v-6a6cc4e4"),p=p(),Te(),p),He={class:"fixed z-1000 bg-dark-page top-0 w-full left-0"},Ue={class:"relative w-full"},Xe=["placeholder","onKeypress"],Ye={key:0,class:"fixed h-full w-full overflow-y-auto px-2 bg-dark-page"},Ze={class:"max-w-full line-clamp-1"},Ge={key:0,class:"text-grey pl-2"},Je={class:"flex items-center mx-3"},Oe={class:"title"},et=Me(()=>i("span",{class:"ml-3 mr-1 h-[1rem] w-[1px] bg-gray-500 inline-block top-0 transform translate-x-[-50%]"},null,-1)),tt={class:"overflow-x-auto text-[14px] text-grey"},at=["onClick"],st={class:"text-subtitle2 text-weight-regular mx-2"},rt={class:"text-grey"},ot={key:0,class:"absolute top-0 h-[100%] w-full pt-[100px]"},lt=["src"],nt={class:"row justify-center q-my-md"},ut=fe({__name:"[keyword]-",setup(p){Ne();const x=me();ve();const{t:y}=he(),R=_e(()=>[[y("tuan"),"top-bo-week"],[y("ngay"),"hot-viewed-today"],[y("thang"),"hot-top-voted"],[y("movie"),"top-le-week"]]),f=S(!1),m=S(""),l=S(""),B=Ke(),{data:J,run:P,error:O}=U(async()=>[...[...new Set(B.items)].filter(a=>a.includes(l.value)),...await ze(l.value)],{manual:!0});T(l,ye(()=>{P(),N("search",{search_term:l.value})},100)),ke(()=>{document.body.style.overflow=f.value?"hidden":""});function ee(a){var r;B.items=[...new Set([...B.items,l.value])],m.value=l.value,N("search",{search_term:l.value}),f.value=!1,(r=a.target)==null||r.blur()}function te(){f.value=!1,m.value&&(m.value="")}async function V(a,r){if(typeof a=="string"){l.value=a;return}if(r){l.value=a.name;return}await x.push(a.path),f.value=!1}const{loading:ae,data:v,run:A,refreshAsync:se,error:re}=U(()=>H("tim-kiem",m.value,1,!0)),oe=a=>se().then(a);T(m,A,{immediate:!0});async function le(a,r){var d,h;if(v.value&&v.value.curPage===v.value.maxPage)return r(!0);const t=await H("tim-kiem",m.value,a+1,!0);v.value={...t,items:[...(h=(d=v.value)==null?void 0:d.items)!=null?h:[],...t.items]},r()}const k=we(new Map);let w;async function ne(a){var r;if(((r=k.get(a))==null?void 0:r.status)!=="success")try{k.set(a,{status:"pending"}),k.set(a,{status:"success",response:await X(a)})}catch(t){k.set(a,{status:"error",response:t})}}async function ue(a,r){k.set(r,{status:"success",response:await X(r)}),a()}const E=S(),I=S(0);T(I,a=>{ne(R.value[a][1])},{immediate:!0});function ce(a){E.value=a,I.value=a.activeIndex}function ie(a){I.value=a.activeIndex}return(a,r)=>(s(),c(_,null,[i("header",He,[n(e(W),{class:"relative"},{default:o(()=>[Q(n(e(ge),{flat:"",dense:"",round:"",class:"mr-2",onClick:te},{default:o(()=>[n(e(b),{icon:"fluent:chevron-left-24-regular",width:"25",height:"25"})]),_:1},512),[[q,m.value||f.value]]),i("div",Ue,[Q(i("input",{class:"w-full bg-[#2a2a2a] placeholder-[#818181] h-[39px] rounded-[30px] focus-visible:outline-none pl-6",placeholder:e(y)("tim-kiem"),"onUpdate:modelValue":r[0]||(r[0]=t=>l.value=t),onKeyup:r[1]||(r[1]=t=>l.value=t.target.value),onFocus:r[2]||(r[2]=t=>f.value=!0),onKeypress:Se(ee,["enter"])},null,40,Xe),[[xe,l.value]]),Q(i("button",{class:"text-[#aaa] absolute right-6 top-0 h-full flex items-center",onClick:r[3]||(r[3]=t=>l.value="")},[n(e(b),{icon:"ep:close-bold"})],512),[[q,l.value]])])]),_:1}),f.value?(s(),c("div",Ye,[n(e(Ee),{dense:""},{default:o(()=>[(s(!0),c(_,null,C(e(J),t=>Q((s(),u(e(Ae),{key:typeof t=="object"?"B"+t.name:t,clickable:"",onClick:d=>V(t)},{default:o(()=>[n(e($),{avatar:"",class:"min-w-0"},{default:o(()=>[typeof t=="object"?(s(),u(e(b),{key:0,icon:"fluent:search-24-regular"})):(s(),u(e(b),{key:1,icon:"fluent:history-24-regular"}))]),_:2},1024),n(e($),null,{default:o(()=>[n(e(Le),{class:"flex items-center"},{default:o(()=>[i("div",Ze,g(typeof t=="object"?t.name:t),1),typeof t=="object"?(s(),c("div",Ge," - "+g(t.status.replace(/vietsub/i,"")),1)):j("",!0)]),_:2},1024)]),_:2},1024),n(e($),{avatar:"",class:"min-w-0",onClick:be(d=>V(t,!0),["stop","prevent"])},{default:o(()=>[n(e(b),{icon:"fluent:arrow-up-left-24-regular"})]),_:2},1032,["onClick"])]),_:2},1032,["onClick"])),[[Re]])),128))]),_:1})])):j("",!0),!m.value&&!f.value?(s(),u(e(W),{key:1},{default:o(()=>[i("div",Je,[i("div",null,[i("div",Oe,g(e(y)("thinh-hanh")),1),et]),i("div",tt,[(s(!0),c(_,null,C(e(R),([t,d],h)=>(s(),c("div",{key:d,class:Ce(["inline-block px-2 py-2",{"text-white text-weight-medium":I.value===h}]),onClick:ct=>{var L;return(L=E.value)==null?void 0:L.slideTo(h)}},g(t),11,at))),128))])])]),_:1})):!f.value&&l.value?(s(),u(e(W),{key:2},{default:o(()=>[i("div",st,[i("span",rt,g(e(y)("ket-qua-tim-kiem-cho")),1),Ie(g(l.value),1)])]),_:1})):j("",!0)]),m.value?(s(),c(_,{key:1},[e(ae)?(s(),u(K,{key:0,class:"absolute pt-[100px]"})):e(v)?(s(),c(_,{key:1},[e(v).items.length===0?(s(),u(Pe,{key:0,class:"absolute pt-[100px]"})):(s(),u(e(M),{key:1,onRefresh:oe},{default:o(()=>[n(e(Ve),{onLoad:le,offset:250,class:"pt-[100px]"},{loading:o(()=>[i("div",nt,[n(e(Qe),{class:"c--main",size:"40px"})])]),default:o(()=>[(s(!0),c(_,null,C(e(v).items,t=>(s(),u(z,{key:t.name,data:{...t,description:"",process:t.process.replace("T\u1EADp ","")},class:"mt-4 mx-3"},{"img-content":o(()=>[n(F)]),_:2},1032,["data"]))),128))]),_:1})]),_:1}))],64)):(s(),u(D,{key:2,"onClick:retry":e(P),class:"absolute pt-[100px]",error:e(O)},null,8,["onClick:retry","error"]))],64)):(s(),c("div",ot,[n(e(We),{"slides-per-view":1,onSwiper:ce,onSlideChange:ie,class:"h-full"},{default:o(()=>[(s(!0),c(_,null,C(e(R),([,t])=>(s(),u(e($e),{key:t,class:"h-full overflow-y-auto scroll-smooth",style:{"white-space":"pre-wrap"}},{default:o(()=>[!(je(w)?w.value=e(k).get(t):w=e(k).get(t))||e(w).status==="pending"?(s(),u(K,{key:0})):e(w).status==="success"?(s(),u(e(M),{key:1,onRefresh:d=>ue(d,t)},{default:o(()=>[(s(!0),c(_,null,C(e(w).response,(d,h)=>(s(),u(z,{key:d.name,data:{...d,description:"",process:d.process.replace("T\u1EADp ","")},class:"mt-4 mx-3"},{"img-content":o(()=>[n(F),h<10?(s(),c("img",{key:0,src:e(qe)[h],class:"h-[1.5rem]"},null,8,lt)):j("",!0)]),_:2},1032,["data"]))),128))]),_:2},1032,["onRefresh"])):(s(),u(D,{key:2,"onClick:retry":e(A),error:e(re)},null,8,["onClick:retry","error"]))]),_:2},1024))),128))]),_:1})]))],64))}});var Tt=pe(ut,[["__scopeId","data-v-6a6cc4e4"]]);export{Tt as default};
